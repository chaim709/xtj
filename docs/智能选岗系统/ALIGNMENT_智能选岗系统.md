# ALIGNMENT - 智能选岗系统

## 阶段1: Align (对齐阶段)

**创建日期**: 2026-01-28  
**状态**: 需求对齐中

---

## 一、项目上下文分析

### 1.1 现有系统架构

```
公考培训管理系统 (gongkao-system)
├── 学员管理模块 (students)     ← 需要集成选岗功能
├── 课程管理模块 (courses)
├── 督学管理模块 (supervision)
├── 作业管理模块 (homework)
└── 数据分析模块 (analytics)
```

### 1.2 现有学员模型字段

**已有字段（可复用）：**
- `name`: 姓名
- `education`: 学历
- `exam_type`: 报考类型（省考/国考）
- `target_position`: 目标岗位
- `id_number`: 身份证号（可推算年龄）
- `address`: 家庭住址（可推断户籍偏好）

**缺失字段（需新增）：**
- `major`: 专业
- `major_category`: 专业大类
- `political_status`: 政治面貌
- `work_years`: 基层工作年限
- `hukou_province`: 户籍省份
- `hukou_city`: 户籍城市
- `gender`: 性别
- `birth_date`: 出生日期

### 1.3 现有数据资源

| 数据文件 | 内容 | 岗位数 |
|----------|------|--------|
| 2024江苏省考职位表 | 包含报名人数、进面分 | 6,677 |
| 2025江苏省考职位表 | 包含竞争比、进面分数线 | 6,818 |
| 2025国考岗位表 | 待解析 | - |
| 专业目录 | 2025/2026年映射 | 待提供 |

---

## 二、原始需求

### 2.1 用户诉求

1. **本地系统集成**：将选岗功能集成到现有学员管理系统
2. **实时数据同步**：支持导入和同步最新报名数据
3. **自动岗位匹配**：新增学员时自动筛选符合条件的岗位
4. **历史数据展示**：显示近3-5年最低进面分
5. **智能推荐**：根据学员条件智能推荐最优岗位
6. **对话式交互**：支持自然语言查询岗位
7. **选岗报告**：生成PDF选岗分析报告

### 2.2 核心使用场景

```
场景1: 新学员入学
┌─────────────────────────────────────────────────────────────┐
│  老师录入学员信息（姓名、学历、专业、政治面貌等）              │
│                        ↓                                    │
│  系统自动筛选符合条件的岗位（省考+国考）                      │
│                        ↓                                    │
│  展示岗位列表 + 历年进面分 + 竞争难度分析                     │
│                        ↓                                    │
│  老师/学员 选择关注的目标岗位                                │
└─────────────────────────────────────────────────────────────┘

场景2: 选岗咨询
┌─────────────────────────────────────────────────────────────┐
│  学员："我想找南京的税务局，竞争不要太激烈的"                  │
│                        ↓                                    │
│  AI理解需求，结合学员条件筛选                                │
│                        ↓                                    │
│  返回推荐岗位 + 推荐理由                                     │
└─────────────────────────────────────────────────────────────┘

场景3: 生成选岗报告
┌─────────────────────────────────────────────────────────────┐
│  基于学员条件和偏好生成PDF报告                               │
│  包含：个人条件分析、推荐岗位TOP10、竞争分析、备考建议        │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、边界确认

### 3.1 功能范围

**在范围内：**
- [x] 岗位数据导入和管理
- [x] 专业目录映射
- [x] 学员条件匹配筛选
- [x] 历史数据统计展示
- [x] 智能推荐算法
- [x] 对话式查询接口
- [x] 选岗报告生成
- [x] 与学员管理系统集成

**不在范围内：**
- [ ] 报名系统对接（官方系统）
- [ ] 实时爬取官方数据
- [ ] 考试成绩管理
- [ ] 面试辅导功能

### 3.2 数据范围

**支持的考试类型：**
- 江苏省考
- 国家公务员考试
- （可扩展其他省份）

**支持的年份：**
- 2024年（历史）
- 2025年（当前）
- 2026年（未来）
- 支持3-5年历史数据对比

---

## 四、需求理解（待确认）

### 4.1 学员信息扩展

需要在学员录入时增加以下字段：

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 专业 | 文本 | 是 | 支持模糊搜索专业目录 |
| 专业大类 | 下拉 | 否 | 系统自动匹配 |
| 政治面貌 | 下拉 | 是 | 党员/预备党员/团员/群众 |
| 基层工作年限 | 数字 | 是 | 0表示无经验 |
| 户籍省份 | 下拉 | 否 | 用于匹配户籍限制岗位 |
| 户籍城市 | 下拉 | 否 | 联动省份 |
| 性别 | 单选 | 是 | 部分岗位有性别限制 |
| 出生日期 | 日期 | 是 | 计算年龄 |

### 4.2 岗位数据模型

```python
class Position(db.Model):
    """岗位模型"""
    id = db.Column(db.Integer, primary_key=True)
    
    # 基本信息
    year = db.Column(db.Integer)           # 年份
    exam_type = db.Column(db.String(20))   # 省考/国考
    region = db.Column(db.String(50))      # 地区
    
    # 单位信息
    department = db.Column(db.String(100)) # 单位名称
    position_code = db.Column(db.String(20)) # 职位代码
    position_name = db.Column(db.String(100)) # 职位名称
    position_desc = db.Column(db.Text)     # 职位简介
    
    # 招录条件
    education = db.Column(db.String(50))   # 学历要求
    major = db.Column(db.Text)             # 专业要求
    political_status = db.Column(db.String(20)) # 政治面貌
    work_years = db.Column(db.Integer)     # 基层年限要求
    other_requirements = db.Column(db.Text) # 其他条件
    
    # 招录信息
    recruit_count = db.Column(db.Integer)  # 招考人数
    exam_category = db.Column(db.String(10)) # 考试类别 A/B/C
    
    # 竞争数据
    apply_count = db.Column(db.Integer)    # 报名人数
    competition_ratio = db.Column(db.Float) # 竞争比
    min_score = db.Column(db.Float)        # 最低进面分
    max_score = db.Column(db.Float)        # 最高进面分
```

### 4.3 匹配规则

**硬性条件匹配（必须满足）：**

| 条件 | 匹配规则 |
|------|----------|
| 学历 | 学历层级匹配（如本科可报"本科及以上"、"仅限本科"等） |
| 专业 | 专业目录映射匹配 |
| 政治面貌 | 党员可报所有，非党员只能报"不限" |
| 基层年限 | 大于等于要求年限 |
| 年龄 | 根据岗位要求计算 |

**软性偏好排序：**

| 偏好 | 权重 |
|------|------|
| 地域偏好 | 高 |
| 单位类型偏好 | 中 |
| 竞争难度 | 中 |
| 发展前景 | 低 |

---

## 五、疑问澄清（已确认/待确认）

### 问题1: 专业目录格式 ✅ 已确认

- [x] 专业目录的文件格式：**PDF格式**
- [x] 是否包含"专业大类→具体专业"的映射关系：**是，共50个专业大类**
- [x] 研究生和本科的专业目录是否分开：**按学历层次分三列（研究生/本科/专科）**

**数据源**：`04-江苏省2026年度考试录用公务员专业参考目录.pdf`

### 问题2: 历史数据范围 ⏳ 待确认

关于近3-5年的历史数据：
- [ ] 2024年数据已有，2023/2022/2021年数据是否可以提供？
- [ ] 历史数据是否都有报名人数和进面分数据？

### 问题3: 对话式交互实现 ⏳ 待确认

对话式交互的技术方案：
- [ ] 方案A: 集成扣子Bot API，利用现有扣子集成能力
- [ ] 方案B: 本地部署对话模型
- [ ] 方案C: 简单的关键词匹配+规则引擎

**建议**：方案A最快，可复用现有扣子集成

### 问题4: 报告输出 ✅ 已确认

- [x] 是否需要带机构Logo：**不需要**
- [x] 报告内容模板是否有参考：**无参考，自行设计**
- [x] 输出格式：**PDF即可**

### 问题5: 学员信息扩展字段 ✅ 已确认

需要在学员录入时新增以下字段：

| 字段 | 类型 | 必填 | 状态 |
|------|------|------|------|
| 专业 | 文本（支持搜索） | 是 | ✅ 确认 |
| 政治面貌 | 下拉 | 是 | ✅ 确认 |
| 基层工作年限 | 数字 | 是 | ✅ 确认 |
| 户籍省份 | 下拉 | 否 | ✅ 确认 |
| 户籍城市 | 下拉 | 否 | ✅ 确认 |
| 性别 | 单选 | 是 | ✅ 确认 |
| 出生日期 | 日期 | 是 | ✅ 确认 |

### 问题6: 数据更新流程 ⏳ 待确认

报名期间的数据更新：
- [ ] 报名数据由谁负责更新？（手动导入Excel？）
- [ ] 更新频率？（每天？实时？）
- [ ] 是否需要报名人数变化提醒功能？

---

## 六、技术约束

### 6.1 系统集成约束

- 必须与现有 Flask + SQLite 架构兼容
- 复用现有的用户权限体系
- 复用现有的前端模板风格

### 6.2 性能约束

- 岗位筛选响应时间 < 2秒
- 支持 10,000+ 岗位数据查询
- 支持多用户并发查询

---

## 七、验收标准（初步）

### 功能验收

- [ ] 支持导入岗位Excel数据
- [ ] 支持专业目录映射
- [ ] 学员详情页显示匹配岗位列表
- [ ] 岗位列表显示历年进面分数据
- [ ] 支持按条件筛选岗位
- [ ] 支持智能推荐排序
- [ ] 支持生成选岗报告PDF
- [ ] 支持对话式查询（可选）

### 数据验收

- [ ] 正确导入2024/2025年岗位数据
- [ ] 正确匹配专业目录
- [ ] 历史数据关联准确

---

## 八、下一步行动

1. **等待用户确认**：
   - 回答疑问澄清中的5个问题
   - 提供专业目录文件
   - 确认历史数据可用性

2. **确认后进入架构设计阶段**

---

**文档状态**: ✅ 已完成  
**下次更新**: 已进入架构设计阶段
