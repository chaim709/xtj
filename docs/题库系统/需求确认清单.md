# 题库系统 - 需求确认清单

## 文档信息
- **创建日期**：2026-01-28
- **更新日期**：2026-01-28
- **状态**：需求确认中
- **目的**：在开发前确认所有需求细节
- **核心需求来源**：题库系统核心需求对话记录.md

---

## 〇、核心设计理念 ✅（来自对话记录）

### 核心痛点
```
当前流程（繁琐）：
督学布置任务 → 学员做题 → 学员报告结果 → 督学手动记录 → 手动分析薄弱项

理想流程（高效）：
督学上传题本 → AI分析分类入库 → 生成二维码 → 学员扫码填错题号 → 自动统计分析
```

### AI智能导入（核心需求） ✅
**每次导入题目时，先用AI分析文档结构，提取内容，再统一格式入库**

```
┌─────────────────────────────────────────────────────────────────┐
│                     AI智能导入流程                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│  【步骤1】督学上传题本（PDF/Word/图片）                           │
│                        ↓                                          │
│  【步骤2】AI自动分析（调用GPT-4V/Claude）                         │
│      ├── OCR识别文字                                             │
│      ├── 提取每道题的题干+选项                                    │
│      ├── 识别正确答案（如果有）                                   │
│      ├── 生成答案解析                                             │
│      ├── 自动分类（三级分类）                                     │
│      ├── 提取考察核心                                             │
│      └── 总结解题技巧                                             │
│                        ↓                                          │
│  【步骤3】督学审核确认（可修改AI分析结果）                         │
│                        ↓                                          │
│  【步骤4】确认入库（统一格式存储）                                 │
│                                                                   │
└─────────────────────────────────────────────────────────────────┘
```

---

## 一、已确认事项 ✅

| 确认项 | 确认结果 | 确认时间 |
|--------|---------|---------|
| 项目结构 | 同一Cursor项目，独立目录 | 2026-01-28 |
| 用户认证 | 共用账号（与督学系统同一套） | 2026-01-28 |
| 题目来源 | PDF + Word文档（每次格式可能不同，AI分析后统一） | 2026-01-28 |
| 初始题库 | 行测套卷练习十一.docx | 2026-01-28 |
| 端口分配 | 督学系统:5000，题库系统:5001 | 2026-01-28 |
| 虚拟环境 | ✅ 已创建 | 2026-01-28 |
| 依赖安装 | ✅ 已完成 | 2026-01-28 |
| **AI导入方式** | ✅ 每次上传后AI分析，形成统一格式 | 2026-01-28 |
| **分类颗粒度** | ✅ 细颗粒度（三级分类） | 2026-01-28 |
| **学员识别** | ✅ 姓名 + 班次/手机尾号 | 2026-01-28 |
| **题目UID** | ✅ 需要全局唯一标识 | 2026-01-28 |

---

## 1.5 题目数据结构（已确认） ✅

```
┌─────────────────────────────────────────────────────────────────┐
│                        题目数据模型                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│  基础信息                                                         │
│  ├── UID: Q-2026-YY-001234  (唯一标识，全局唯一)                  │
│  ├── 题本ID: TB-2026-001    (所属题本)                           │
│  ├── 题本内序号: 15         (在该题本中的第几题)                  │
│  │                                                                │
│  题目内容                                                         │
│  ├── 题干: "根据以下材料，回答问题..."                           │
│  ├── 选项A: "经济发展是..."                                      │
│  ├── 选项B: "社会进步是..."                                      │
│  ├── 选项C: "文化建设是..."                                      │
│  ├── 选项D: "生态保护是..."                                      │
│  ├── 正确答案: B                                                  │
│  ├── 答案解析: "本题考查的是..."                                 │
│  │                                                                │
│  分类标签（三级细颗粒度）                                          │
│  ├── 科目: 言语理解与表达                                        │
│  ├── 一级分类: 片段阅读                                          │
│  ├── 二级分类: 主旨概括题                                        │
│  ├── 三级分类: 关联词主旨题                                      │
│  │                                                                │
│  教学辅助                                                         │
│  ├── 考察核心: "转折关系、关联词定位重点"                        │
│  ├── 解题技巧: "抓住'但是、然而'等转折词，转折后是重点"          │
│  ├── 难度等级: 中等                                              │
│  └── 易错点: "容易被选项A的干扰信息迷惑"                         │
│                                                                   │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1.6 核心功能模块（已确认） ✅

| 优先级 | 模块 | 功能 | 状态 |
|--------|------|------|------|
| **P0** | 题本管理 | 题本上传、AI解析、督学审核 | ✅ 确认 |
| **P0** | 题目管理 | 题目CRUD、分类管理、UID生成 | ✅ 确认 |
| **P0** | AI解析模块 | 智能识别题干/选项/答案/分类 | ✅ 确认 |
| **P0** | 练习任务 | 创建任务、关联题本、生成二维码 | ✅ 确认 |
| **P0** | 学员提交(H5) | 扫码提交、填写错题号、无需登录 | ✅ 确认 |
| **P0** | 错题分析 | 自动匹配题目、统计薄弱项、生成错题集 | ✅ 确认 |
| **P1** | 专项练习 | 按知识点刷题（在线答题） | 待确认 |
| **P1** | 套卷练习 | 完整套卷、限时答题 | 待确认 |
| **P1** | 错题本 | 自动收集错题、回顾练习 | 待确认 |
| **P1** | 个人统计 | 刷题量、正确率、薄弱项趋势 | 待确认 |
| **P2** | 班级统计 | 班级整体分析、学员排名 | 待确认 |
| **P2** | 督学系统对接 | API同步学员信息、推送薄弱项 | ✅ 确认 |

---

## 二、已确认事项（2026-01-28 完整确认） ✅

### 1️⃣ 题目导入相关 ✅

#### Q1: 答案来源 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 答案来源 | ✅ **有对应的答案文档**，可以补充和解析 |
| 题目格式 | ✅ **格式不固定**，每次来源不同，AI处理后统一格式 |

---

#### Q2: 题目导入方式 ✅ 已确认

| 导入方式 | 状态 | 说明 |
|----------|------|------|
| **Word导入** | ✅ 第一期 | 通过AI/大模型解析 |
| **PDF导入** | ✅ 第一期 | 通过AI/大模型解析 |
| **Excel导入** | ✅ 可选 | 固定格式时使用 |
| **手动录入** | ✅ 可选 | 固定格式时使用 |

**核心导入策略（通过Dify/n8n）**：
```
方式A: 大模型智能解析（推荐）
├── 通过Dify或n8n上传文件
├── 大模型自动拆解和处理
├── 输出统一格式
└── 不受文档结构错乱影响

方式B: 固定格式导入（备选）
├── PDF/Excel固定模板
└── 手动录入
```

---

### 2️⃣ 功能细节相关 ✅

#### Q4: 刷题模式详情 ✅ 已确认

**专项练习：**
| 配置项 | 确认结果 |
|--------|---------|
| 发题数量 | ✅ **用户自选**（可选择不同数量） |
| 多知识点混合 | ✅ **支持**多个知识点混合练习 |

**套卷练习：**
| 配置项 | 确认结果 |
|--------|---------|
| 限时设置 | ✅ **可选择**强制限时或不限时 |
| 中途退出 | ✅ **自动保存**答题进度 |

---

#### Q5: 答题交互方式 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 答题模式 | ✅ **B: 选择后不判断，全部答完后统一判断** |

---

#### Q6: 解析内容 ✅ 已确认

| 解析内容 | 状态 |
|----------|------|
| 正确答案 | ✅ 包含 |
| 文字解析 | ✅ 包含 |
| 知识点标签 | ✅ 包含 |
| 相关知识点链接 | ✅ 包含 |
| 易错点提示 | ✅ 包含 |

---

#### Q7: 错题本功能 ✅ 已确认

| 配置项 | 确认结果 |
|--------|---------|
| 错题移除条件 | ✅ **B: 连续答对2次移除** |
| 添加笔记 | ✅ **支持**添加笔记 |

---

### 3️⃣ 数据同步相关 ✅

#### Q8: 与督学系统同步内容 ✅ 已确认

| 同步数据 | 状态 |
|----------|------|
| 薄弱项（知识点正确率） | ✅ 同步 |
| 每日刷题量 | ✅ 同步 |
| 错题数量 | ✅ 同步 |
| 最近练习时间 | ✅ 同步 |
| 练习详情 | ✅ 同步 |

**重要**：督学系统也需要添加接收数据的API接口

---

#### Q9: 同步时机 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 同步时机 | ✅ **C: 每天定时同步** |

---

### 4️⃣ 界面设计相关 ✅

#### Q10: 界面风格 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 界面风格 | ✅ **保持一致但有题库特色** |

---

#### Q11: 学员首页显示 ✅ 已确认

| 首页内容 | 状态 |
|----------|------|
| 最近刷题数量 | ✅ 显示 |
| 薄弱项 | ✅ 显示 |
| 刷题统计 | ✅ 显示 |
| 其他内容 | ✅ 可自由设计 |

---

#### Q12: 统计图表 ✅ 已确认

| 图表类型 | 状态 |
|----------|------|
| 各模块正确率雷达图 | ✅ 需要 |
| 刷题趋势折线图 | ✅ 需要 |
| 错题分布饼图 | ✅ 需要 |
| 正确率变化趋势 | ✅ 需要 |
| **结论** | ✅ **尽量都要有** |

---

### 5️⃣ 题目管理相关 ✅

#### Q13: 题目审核流程 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 审核方式 | ✅ **C: 标记为"待审核"**，可预览但不出现在练习中 |
| 批量审核 | ✅ **支持**批量审核功能 |

---

#### Q14: 题目难度 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 标记难度 | ✅ **是**（困难/容易） |
| 确定方式 | ✅ **根据学员正确率自动计算** |

---

#### Q15: 题目来源标记 ✅ 已确认

| 确认项 | 确认结果 |
|--------|---------|
| 标记来源 | ✅ **是**（如真题、模拟题等） |

---

### 6️⃣ 权限相关 ✅

#### Q16: 督学人员权限 ✅ 已确认

| 权限 | 状态 |
|------|------|
| 查看学员刷题情况 | ✅ 有 |
| 布置刷题任务 | ✅ 有 |
| 查看学员错题 | ✅ 有 |
| 管理题目 | ✅ 有 |
| **总结** | ✅ **可查看全部信息** |

---

#### Q17: 学员权限 ✅ 已确认

| 权限 | 状态 |
|------|------|
| 自主刷题 | ✅ 有 |
| 查看自己的错题 | ✅ 有 |
| 查看自己的统计 | ✅ 有 |
| 查看班级排名 | ✅ 有 |
| **限制** | ❌ 不能查看其他学员信息 |

---

## 三、业务流程确认 ✅

### 流程1: 督学布置刷题任务 ✅ 已确认

```
1. 督学在督学系统创建作业（指定模块、题数）
2. 学员在题库系统看到任务
3. 学员完成刷题
4. 数据自动同步回督学系统
```

| 确认项 | 确认结果 |
|--------|---------|
| 任务同步方式 | ✅ **A: 通过API实时同步** |

---

### 流程2: 学员自主刷题 ✅ 已确认

```
1. 学员登录题库系统
2. 选择知识点和题数
3. 开始练习
4. 答题（不即时判断）
5. 全部答完后统一判断，查看解析
6. 错题自动加入错题本
7. 薄弱项自动更新
8. 数据同步到督学系统（每天定时）
```

✅ **流程确认无误**

---

## 四、第一期（MVP）功能确认 ✅

| 功能 | 第一期 | 优先级 | 备注 |
|------|--------|--------|------|
| 题目管理（CRUD） | ✅ 是 | P0 | |
| Word导入 | ✅ 是 | P0 | 通过Dify/n8n AI解析 |
| PDF导入 | ✅ 是 | P0 | 通过Dify/n8n AI解析 |
| Excel导入 | ✅ 是 | P1 | 固定格式备选 |
| 专项练习 | ✅ 是 | P0 | 用户自选题数+多知识点混合 |
| 套卷练习 | ✅ 是 | P1 | 可选限时，中途自动保存 |
| 错题本 | ✅ 是 | P0 | 连续2次答对移出+笔记 |
| 个人统计 | ✅ 是 | P0 | 含雷达图等图表 |
| 班级统计 | ✅ 是 | P1 | 含排名 |
| 督学系统对接 | ✅ 是 | P0 | 每天定时同步 |
| 督学布置任务 | ✅ 是 | P0 | API实时同步 |

---

## 五、技术实现补充

### 5.1 Dify/n8n集成方案

根据用户倾向，题目导入优先通过Dify/n8n处理：

```
┌─────────────────────────────────────────────────────────────────┐
│  方案: 通过Dify/n8n处理文档                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│  [题库系统] ──上传文件──> [Dify/n8n工作流]                         │
│                              │                                    │
│                    ┌─────────┴─────────┐                          │
│                    │  大模型处理流程    │                          │
│                    │  1. 识别文档结构   │                          │
│                    │  2. 拆解题目      │                          │
│                    │  3. 提取选项      │                          │
│                    │  4. 识别答案      │                          │
│                    │  5. 生成解析      │                          │
│                    │  6. 自动分类      │                          │
│                    │  7. 提取考察核心   │                          │
│                    │  8. 总结解题技巧   │                          │
│                    └─────────┬─────────┘                          │
│                              │                                    │
│  [题库系统] <──返回JSON──────┘                                     │
│       │                                                           │
│       ▼                                                           │
│  督学审核 → 存入数据库（统一格式）                                  │
│                                                                   │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 督学系统需要新增的接口

| 接口 | 用途 |
|------|------|
| `POST /api/v1/sync/practice` | 接收题库系统的练习数据 |
| `POST /api/v1/sync/weakness` | 接收题库系统的薄弱项更新 |
| `POST /api/v1/sync/mistakes` | 接收题库系统的错题统计 |
| `GET /api/v1/tasks` | 题库系统获取督学布置的任务 |
| `POST /api/v1/tasks` | 督学在督学系统创建刷题任务 |

---

## 六、确认记录

| 日期 | 确认人 | 确认内容 | 备注 |
|------|--------|---------|------|
| 2026-01-28 | 用户 | 项目结构、用户认证、题目来源 | 初始确认 |
| 2026-01-28 | 用户 | AI导入方式、分类颗粒度、学员识别 | 对话记录需求 |
| 2026-01-28 | 用户 | **Q1-Q17 全部确认** | 功能细节 |
| 2026-01-28 | 用户 | **流程1/2 全部确认** | 业务流程 |
| 2026-01-28 | 用户 | **MVP功能范围确认** | 优先级确认 |

---

## ✅ 需求确认完成！可以开始开发！
