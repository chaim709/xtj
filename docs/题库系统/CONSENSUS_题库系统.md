# 共识文档 - 公考题库系统

## 文档信息
- **创建日期**：2026-01-28
- **文档版本**：v1.0
- **任务阶段**：Consensus（共识阶段）
- **依赖文档**：ALIGNMENT_题库系统.md

---

## 1. 需求共识

### 1.1 项目定位

公考题库系统是一个**独立部署**的在线刷题平台，与现有督学管理系统通过API对接，为公考培训机构的学员提供：

- 📝 **在线刷题**：行测客观题练习
- 📊 **数据分析**：自动统计正确率和薄弱项
- 📚 **错题管理**：自动收集错题，支持回顾练习
- 🔗 **系统联动**：与督学系统实时同步学习数据

### 1.2 目标用户

| 用户类型 | 数量 | 核心需求 |
|---------|------|---------|
| 管理员 | 1-2人 | 题目管理、知识点管理、数据统计 |
| 督学人员 | 2-4人 | 查看学员刷题情况、指导学习 |
| 学员 | 30-100人 | 刷题练习、查看错题、了解进度 |

### 1.3 核心功能清单

#### 第一期（MVP）功能

| 模块 | 功能 | 优先级 | 说明 |
|------|------|--------|------|
| **题目管理** | 题目增删改查 | P0 | 管理员操作 |
| | 题目批量导入 | P0 | Excel导入 |
| | 知识点分类管理 | P0 | 三级分类 |
| **刷题练习** | 专项练习 | P0 | 按知识点刷题 |
| | 套卷练习 | P0 | 完整套卷练习 |
| | 答题记录 | P0 | 记录每次答题 |
| **错题本** | 自动收集错题 | P0 | 答错自动加入 |
| | 错题回顾 | P0 | 重新练习错题 |
| **数据统计** | 个人刷题统计 | P1 | 学员查看 |
| | 薄弱项分析 | P1 | 自动识别 |
| | 班级数据概览 | P1 | 管理员查看 |
| **系统对接** | 督学系统API对接 | P0 | 同步薄弱项 |
| | 用户认证对接 | P0 | 统一账号 |

#### 第二期功能（预留）

| 功能 | 说明 |
|------|------|
| 每日一练 | 每天自动推送随机题目 |
| 智能组卷 | 根据薄弱项智能组卷 |
| 移动端H5 | 手机端刷题 |
| 申论练习 | 主观题练习与评分 |

---

## 2. 技术共识

### 2.1 技术栈确认

| 类别 | 技术 | 版本 | 理由 |
|------|------|------|------|
| 后端语言 | Python | 3.9+ | 与督学系统一致 |
| 后端框架 | Flask | 2.3+ | 与督学系统一致 |
| ORM | SQLAlchemy | 2.0+ | 与督学系统一致 |
| 数据库 | SQLite | 开发环境 | 简单部署 |
| 数据库 | PostgreSQL | 生产环境 | 可与督学系统共用 |
| 前端UI | Bootstrap 5 | 5.3+ | 与督学系统一致 |
| 前端JS | jQuery | 3.7+ | 简单交互 |
| 认证 | Flask-Login | 0.6+ | Session认证 |
| API认证 | API Key | - | 系统间调用 |

### 2.2 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                     用户访问层                               │
├──────────────────────┬──────────────────────────────────────┤
│    题库系统 Web      │         督学系统 Web                 │
│   tiku.xxx.com       │        admin.xxx.com                 │
└──────────┬───────────┴────────────────┬─────────────────────┘
           │                            │
           ↓                            ↓
┌──────────────────────┐    ┌──────────────────────┐
│    题库系统后端      │◄──►│    督学系统后端      │
│    Flask App         │API │    Flask App         │
│    Port: 5001        │    │    Port: 5000        │
└──────────┬───────────┘    └──────────┬───────────┘
           │                            │
           ↓                            ↓
┌──────────────────────────────────────────────────────────────┐
│                    数据库层                                   │
├──────────────────────┬───────────────────────────────────────┤
│   题库数据库         │         督学数据库                    │
│   tiku.db            │         gongkao.db                    │
└──────────────────────┴───────────────────────────────────────┘
```

### 2.3 部署方案

| 阶段 | 部署方式 | 说明 |
|------|---------|------|
| 开发阶段 | 本地Mac | Flask开发服务器 |
| 测试阶段 | 本地Mac | 两个系统同时运行 |
| 生产阶段 | 云服务器 | Nginx + Gunicorn |

---

## 3. 数据共识

### 3.1 题目类型

| 题型 | 支持状态 | 说明 |
|------|---------|------|
| 单选题 | ✅ 支持 | 行测主要题型 |
| 多选题 | ✅ 支持 | 部分知识点 |
| 判断题 | ✅ 支持 | 常识判断 |
| 填空题 | ❌ 不支持 | 第二期 |
| 主观题 | ❌ 不支持 | 申论需人工评分 |

### 3.2 知识点分类体系

采用三级分类结构：

```
一级分类（科目）
├── 二级分类（模块）
│   ├── 三级分类（知识点）
│   │   └── 题目
```

**完整分类体系：**

```
行测
├── 常识判断
│   ├── 科技常识
│   ├── 法律常识
│   ├── 时事政治
│   ├── 地理常识
│   ├── 人文历史
│   └── 经济常识
├── 言语理解与表达
│   ├── 篇章阅读
│   ├── 语句表达
│   │   ├── 语句排序
│   │   └── 语句衔接
│   ├── 逻辑填空
│   │   ├── 实词辨析
│   │   └── 成语辨析
│   └── 片段阅读
│       ├── 主旨概括
│       ├── 意图判断
│       └── 细节理解
├── 数量关系
│   ├── 数学运算
│   │   ├── 行程问题
│   │   ├── 工程问题
│   │   ├── 经济利润
│   │   ├── 排列组合
│   │   ├── 概率问题
│   │   ├── 几何问题
│   │   ├── 容斥问题
│   │   └── 比赛计数
│   └── 数字推理
├── 判断推理
│   ├── 图形推理
│   │   ├── 规律类
│   │   ├── 重构类
│   │   └── 分类分组
│   ├── 定义判断
│   ├── 类比推理
│   └── 逻辑判断
│       ├── 翻译推理
│       ├── 真假推理
│       ├── 分析推理
│       ├── 削弱加强
│       └── 前提假设
└── 资料分析
    ├── 增长率计算
    ├── 比重问题
    ├── 平均数问题
    └── 综合分析
```

### 3.3 数据同步策略

| 数据项 | 同步方向 | 同步时机 | 同步方式 |
|--------|---------|---------|---------|
| 用户信息 | 督学→题库 | 登录时 | API查询 |
| 刷题记录 | 题库→督学 | 完成练习后 | API推送 |
| 薄弱项 | 题库→督学 | 完成练习后 | API推送 |
| 知识点分类 | 共享 | 初始化 | 数据同步 |

---

## 4. 业务规则共识

### 4.1 刷题规则

| 规则 | 说明 |
|------|------|
| 答题模式 | 单题作答，立即显示对错 |
| 答案修改 | 提交后不可修改 |
| 时间限制 | 专项练习无时间限制，套卷有时间限制 |
| 中途退出 | 自动保存已答题目 |

### 4.2 错题规则

| 规则 | 说明 |
|------|------|
| 加入条件 | 答错自动加入错题本 |
| 移除条件 | 连续2次答对后移除 |
| 保留时间 | 永久保留 |

### 4.3 薄弱项判定规则

| 正确率 | 等级 | 颜色标记 |
|--------|------|---------|
| < 50% | 急需攻克 | 🔴 红色 |
| 50%-70% | 需加强 | 🟡 黄色 |
| > 70% | 掌握良好 | 🟢 绿色 |

**判定条件：**
- 某知识点答题数量 >= 10题
- 根据最近20次答题计算正确率

---

## 5. 接口共识

### 5.1 题库系统提供的API

```
# 获取学员刷题统计
GET /api/v1/practice/stats/{student_id}
Response: {
  "total_questions": 500,
  "correct_count": 340,
  "accuracy_rate": 68.0,
  "practice_days": 15,
  "weaknesses": [
    {"module": "数量关系", "sub_module": "排列组合", "accuracy": 45.0}
  ]
}

# 获取学员最近刷题记录
GET /api/v1/practice/recent/{student_id}?limit=10
Response: {
  "records": [
    {"date": "2026-01-28", "module": "图形推理", "count": 50, "accuracy": 72.0}
  ]
}
```

### 5.2 调用督学系统的API

```
# 验证用户身份
POST /api/v1/auth/verify
Request: {"token": "xxx"}
Response: {"valid": true, "user_id": 1, "role": "student"}

# 更新学员薄弱项
POST /api/v1/students/{id}/weakness
Request: {
  "source": "tiku",
  "module": "数量关系",
  "sub_module": "排列组合",
  "accuracy_rate": 45.0,
  "practice_count": 20
}

# 获取学员基本信息
GET /api/v1/students/{id}
Response: {"id": 1, "name": "张三", "class_name": "春季班", ...}
```

---

## 6. 验收标准

### 6.1 功能验收

| 功能 | 验收标准 |
|------|---------|
| 题目管理 | 可增删改查题目，支持Excel批量导入 |
| 知识点管理 | 三级分类可配置 |
| 专项练习 | 学员可按知识点选题刷题 |
| 套卷练习 | 学员可完成完整套卷，有时间限制 |
| 错题本 | 错题自动收集，可重新练习 |
| 数据统计 | 正确率、刷题量、薄弱项统计正确 |
| 系统对接 | 薄弱项能正确同步到督学系统 |

### 6.2 性能验收

| 指标 | 标准 |
|------|------|
| 页面加载时间 | < 2秒 |
| 答题提交响应 | < 500ms |
| 并发用户数 | 支持30人同时在线 |
| 题库容量 | 支持10000+题目 |

### 6.3 用户体验验收

| 指标 | 标准 |
|------|------|
| 界面一致性 | 与督学系统风格一致 |
| 操作便捷性 | 刷题流程简洁，3步内开始答题 |
| 错误提示 | 友好的错误提示信息 |
| 移动端兼容 | 手机浏览器可正常使用 |

---

## 7. 项目约束

### 7.1 时间约束

| 阶段 | 周期 |
|------|------|
| 设计阶段 | 1周 |
| 开发阶段 | 4-6周 |
| 测试阶段 | 1周 |
| 总计 | 6-8周 |

### 7.2 资源约束

| 资源 | 数量 |
|------|------|
| 开发人员 | 1人（AI辅助） |
| 服务器 | 与督学系统共用 |
| 域名 | 子域名或子路径 |

### 7.3 技术约束

- 必须与督学系统技术栈保持一致
- 必须通过API与督学系统对接
- 不能影响督学系统的正常运行

---

## 8. 风险识别

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|---------|
| 题目导入格式不兼容 | 中 | 中 | 提供标准导入模板 |
| API对接问题 | 低 | 高 | 先测试对接再开发功能 |
| 性能问题 | 低 | 中 | 分页加载，缓存优化 |
| 用户体验不佳 | 中 | 中 | 参考成熟题库产品设计 |

---

## 9. 确认清单

### 核心确认项

- [x] 功能范围：第一期MVP功能确认
- [x] 技术栈：与督学系统保持一致
- [x] 知识点体系：三级分类结构
- [x] 数据同步：练习完成后同步
- [x] 用户认证：与督学系统对接

### 待确认项

- [ ] 题目来源：Excel导入格式
- [ ] 初始题库：是否有现成题目资料
- [ ] 部署方式：子域名还是子路径

---

*文档状态：共识达成 ✅*
