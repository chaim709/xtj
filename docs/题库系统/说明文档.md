# 公考题库系统 - 项目说明文档

## 文档信息
- **创建日期**：2026-01-28
- **更新日期**：2026-01-28
- **项目状态**：✅ 需求确认完成，准备开发
- **开发周期**：预计8-10周

---

## 1. 项目概述

### 1.1 项目定位

公考题库系统是公考培训机构的**在线刷题平台**，作为督学管理系统的配套产品，为学员提供行测刷题练习、套卷模拟、错题回顾等功能。

### 1.2 与督学系统的关系

```
┌─────────────────────┐     API对接     ┌─────────────────────┐
│    督学管理系统      │◄──────────────►│    题库系统         │
│                     │                 │                     │
│  • 学员管理         │  同步薄弱项     │  • 在线刷题         │
│  • 督学日志         │  ◄────────────  │  • 套卷考试         │
│  • 作业管理         │                 │  • 错题本           │
│  • 数据分析         │  验证用户       │  • 刷题统计         │
│                     │  ────────────►  │                     │
└─────────────────────┘                 └─────────────────────┘
```

### 1.3 核心价值

| 用户 | 价值 |
|------|------|
| 学员 | 随时随地刷题，自动记录错题，了解薄弱项 |
| 督学人员 | 实时了解学员刷题情况，精准指导 |
| 管理员 | 统一管理题库，数据分析决策 |

---

## 2. 文档清单

| 文档 | 内容 | 状态 |
|------|------|------|
| [ALIGNMENT_题库系统.md](./ALIGNMENT_题库系统.md) | 需求对齐、边界确认、疑问澄清 | ✅ 完成 |
| [CONSENSUS_题库系统.md](./CONSENSUS_题库系统.md) | 需求共识、技术共识、验收标准 | ✅ 完成 |
| [DESIGN_题库系统.md](./DESIGN_题库系统.md) | 架构设计、数据库设计、接口设计 | ✅ 完成 |
| [TASK_题库系统.md](./TASK_题库系统.md) | 任务分解、依赖关系、执行计划 | ✅ 完成 |

---

## 3. 功能范围

### 3.1 第一期功能（MVP）- 已确认 ✅

```
题库系统
├── 📚 题目管理
│   ├── 题目增删改查
│   ├── Word/PDF导入（通过Dify/n8n AI解析）⭐
│   ├── Excel批量导入（固定格式备选）
│   ├── 知识点分类管理（三级）
│   ├── 题目难度标记（根据正确率自动计算）
│   └── 题目来源标记（真题/模拟题）
│
├── ✏️ 刷题练习
│   ├── 专项练习（用户自选题数+多知识点混合）
│   ├── 套卷练习（可选限时，中途自动保存）
│   ├── 答题模式：全部答完后统一判断
│   └── 答题记录
│
├── 📝 错题本
│   ├── 自动收集错题
│   ├── 错题回顾练习
│   ├── 掌握状态跟踪（连续2次答对移出）
│   └── 支持添加笔记
│
├── 📊 数据统计
│   ├── 个人刷题统计（首页看板）
│   ├── 薄弱项分析
│   ├── 班级数据概览+排名
│   ├── 正确率雷达图
│   ├── 刷题趋势折线图
│   └── 错题分布饼图
│
└── 🔗 系统对接
    ├── 用户认证对接（共用账号）
    ├── 督学布置任务（API实时同步）
    └── 练习数据同步（每天定时同步）
```

### 3.2 第二期功能（预留）

- 每日一练（随机推送）
- 智能组卷（基于薄弱项）
- 移动端H5优化
- 申论主观题练习

---

## 4. 技术方案

### 4.1 技术栈

| 层次 | 技术 | 说明 |
|------|------|------|
| 后端 | Python Flask | 与督学系统一致 |
| ORM | SQLAlchemy | 与督学系统一致 |
| 数据库 | SQLite/PostgreSQL | 开发用SQLite |
| 前端 | Bootstrap 5 + jQuery | 与督学系统一致 |
| 认证 | Flask-Login | Session认证 |

### 4.2 目录结构

```
tiku-system/
├── app/
│   ├── models/          # 数据模型
│   ├── routes/          # 路由层
│   ├── services/        # 服务层
│   ├── templates/       # HTML模板
│   ├── static/          # 静态资源
│   └── utils/           # 工具类
├── config.py            # 配置文件
├── requirements.txt     # 依赖列表
└── run.py              # 启动文件
```

### 4.3 数据库表

| 表名 | 用途 |
|------|------|
| users | 用户（与督学系统关联） |
| categories | 知识点分类（三级） |
| questions | 题目 |
| exams | 套卷 |
| practices | 练习记录 |
| practice_details | 练习答题明细 |
| exam_records | 考试记录 |
| exam_answers | 考试答题明细 |
| mistakes | 错题 |
| weaknesses | 薄弱项统计 |

---

## 5. 开发计划

### 5.1 阶段划分

| 阶段 | 内容 | 周期 |
|------|------|------|
| Phase 0 | 项目初始化 | 2天 |
| Phase 1 | 基础模块（认证、权限、模板） | 1周 |
| Phase 2 | 题目管理 | 1周 |
| Phase 3 | 刷题练习 | 1.5周 |
| Phase 4 | 套卷考试 | 1周 |
| Phase 5 | 错题本 | 0.5周 |
| Phase 6 | 统计与对接 | 1周 |
| Phase 7 | 测试与优化 | 1周 |

### 5.2 里程碑

| 里程碑 | 内容 | 时间节点 |
|--------|------|---------|
| M1 | 基础框架+题目管理可用 | Week 2 结束 |
| M2 | 刷题练习功能可用 | Week 4 结束 |
| M3 | 全部功能开发完成 | Week 6 结束 |
| M4 | 测试优化完成，可上线 | Week 7-8 |

---

## 6. 知识点分类体系

```
行测
├── 常识判断
│   ├── 科技常识
│   ├── 法律常识
│   ├── 时事政治
│   ├── 地理常识
│   ├── 人文历史
│   └── 经济常识
├── 言语理解与表达
│   ├── 篇章阅读
│   ├── 语句表达（语句排序、语句衔接）
│   ├── 逻辑填空（实词辨析、成语辨析）
│   └── 片段阅读（主旨概括、意图判断、细节理解）
├── 数量关系
│   ├── 数学运算（行程、工程、经济、排列组合、概率、几何、容斥）
│   └── 数字推理
├── 判断推理
│   ├── 图形推理（规律类、重构类、分类分组）
│   ├── 定义判断
│   ├── 类比推理
│   └── 逻辑判断（翻译推理、真假推理、分析推理、削弱加强）
└── 资料分析
    ├── 增长率计算
    ├── 比重问题
    ├── 平均数问题
    └── 综合分析
```

---

## 7. 已确认事项 ✅ (2026-01-28 完整确认)

### 项目结构确认

**决策：同一个Cursor项目，两个应用目录**

```
公考项目/                          # 同一个Cursor工作区
├── gongkao-system/                # 督学管理系统（端口5000）
├── gongkao-tiku-system/           # 题库系统（端口5001）
└── docs/                          # 共享文档
```

### 题目导入方案（核心）⭐

**导入策略**：
| 方式 | 说明 | 优先级 |
|------|------|--------|
| **Dify/n8n AI解析** | 上传文件 → 大模型拆解 → 统一格式 | ✅ 推荐 |
| Word/PDF直接解析 | 固定格式时使用 | P1 |
| Excel模板导入 | 固定格式备选 | P1 |

**AI解析流程**：
```
题库系统 → Dify/n8n工作流 → 大模型处理 → JSON结果 → 督学审核 → 入库
```

### 功能细节确认

| 功能 | 确认结果 |
|------|---------|
| **答题模式** | 选择后不判断，全部答完统一判断 |
| **错题移出** | 连续答对2次移出 |
| **错题笔记** | ✅ 支持添加笔记 |
| **题目难度** | 根据学员正确率自动计算 |
| **题目来源** | 需要标记（真题/模拟题等） |
| **刷题数量** | 用户自选 |
| **知识点混合** | ✅ 支持多知识点混合 |
| **套卷限时** | 可选择强制或不强制 |
| **中途退出** | 自动保存 |

### 数据同步确认

| 同步项 | 同步方式 |
|--------|---------|
| 督学布置任务 | ✅ API实时同步 |
| 练习数据 | ✅ 每天定时同步 |
| 同步内容 | 薄弱项、刷题量、错题数、练习时间、详情 |

### 权限确认

| 角色 | 权限 |
|------|------|
| 督学人员 | 查看全部信息、布置任务、管理题目 |
| 学员 | 自主刷题、个人错题、个人统计、班级排名 |

---

## 8. 下一步行动

### 8.1 已完成 ✅

- [x] 确认项目结构（同一Cursor项目）
- [x] 确认用户体系（共用账号）
- [x] 确认题目来源（PDF/Word）
- [x] 创建项目目录结构
- [x] 创建基础配置文件
- [x] 安装Python依赖 ✅
- [x] **需求全面确认完成** ✅ (2026-01-28)

### 8.2 待开发任务

**开发顺序**（按 [TASK_题库系统.md](./TASK_题库系统.md)）：

| 阶段 | 任务 | 状态 |
|------|------|------|
| **Phase 0** | 项目框架搭建 | ✅ 已完成 |
| **Phase 1** | 基础模块（认证、权限、模板） | 待开发 |
| **Phase 2A** | 题本管理 + AI解析（核心）⭐ | 待开发 |
| **Phase 2B** | 二维码扫码提交（核心）⭐ | 待开发 |
| Phase 3 | 在线刷题练习 | 待开发 |
| Phase 4 | 套卷考试 | 待开发 |
| Phase 5 | 错题本增强 | 待开发 |
| Phase 6 | 统计与对接 | 待开发 |
| Phase 7 | 测试与优化 | 待开发 |

### 8.3 督学系统需新增接口

| 接口 | 用途 |
|------|------|
| `POST /api/v1/sync/practice` | 接收练习数据 |
| `POST /api/v1/sync/weakness` | 接收薄弱项更新 |
| `POST /api/v1/sync/mistakes` | 接收错题统计 |
| `GET /api/v1/tasks` | 获取督学布置的任务 |
| `POST /api/v1/tasks` | 创建刷题任务 |

### 8.4 Dify/n8n工作流（待搭建）

需要搭建大模型处理工作流：
1. 接收上传的PDF/Word文件
2. 识别文档结构，拆解题目
3. 提取题干、选项、答案
4. 生成解析、分类、考察核心、解题技巧
5. 返回JSON格式结果

---

## 9. 相关资源

- 督学系统代码：`/Users/chaim/CodeBuddy/公考项目/gongkao-system/`
- 督学系统API文档：`/api/v1/` 接口
- 原始需求PRD：`/Users/chaim/CodeBuddy/公考项目/公考培训机构管理系统/公考培训机构管理系统PRD.md`

---

*文档最后更新：2026-01-28*
