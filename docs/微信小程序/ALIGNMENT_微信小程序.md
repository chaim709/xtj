# 公考学员服务微信小程序 - 对齐文档

> 6A工作流 - 阶段1: Align（对齐阶段）
> 创建日期: 2026-02-01

---

## 一、项目上下文分析

### 1.1 现有系统概况

| 项目 | 内容 |
|-----|------|
| 系统名称 | 公考培训机构管理系统 |
| 技术栈 | Flask + SQLite + Jinja2模板 |
| 部署地址 | https://shxtj.chaim.top |
| 服务器 | RackNerd VPS |
| 仓库 | https://github.com/chaim709/xtj.git |

### 1.2 现有功能模块

| 模块 | 功能 | 小程序复用情况 |
|-----|------|--------------|
| 学员管理 | 学员信息、状态、薄弱项 | ✅ 需要API对接 |
| 课程管理 | 项目/班型/班次/课表/录播课 | ✅ 核心功能 |
| 督学管理 | 督学记录、跟进计划、模板 | ✅ 核心功能 |
| 题库系统 | 题目/题册/错题/复习 | ⭕ 辅助功能 |
| 作业管理 | 作业布置/提交/批改 | ✅ 需要对接 |
| 职位表 | 职位筛选/进面分数 | ⭕ 可选功能 |

### 1.3 现有技术资产

#### 已有API接口（可复用）
- `/api/v1/students` - 学员列表/详情
- `/api/v1/students/search` - 学员搜索
- `/api/v1/batches` - 班次管理
- `/api/v1/supervision/logs` - 督学记录
- `/api/v1/homework/batch-push` - 作业推送
- `/api/v1/reminders/pending` - 待办事项
- `/api/v1/reports/weekly` - 周报数据

#### 已有H5移动端（参考价值）
- `/h5/home/<student_id>` - 学员主页
- `/h5/practice/<student_id>` - 错题练习
- `/h5/review/<student_id>` - 复习中心
- `/h5/plan/<student_id>` - 学习计划

#### 已有数据模型
- `Student` - 学员信息（含微信字段wechat）
- `CourseRecording` - 录播课（含链接recording_url）
- `Schedule` - 课表（含日期、科目、老师）
- `SupervisionLog` - 督学记录
- `HomeworkTask/HomeworkSubmission` - 作业

---

## 二、原始需求

### 2.1 用户陈述
> "我的机构管理系统已经做的非常好了，现在我想做相关的微信小程序"

### 2.2 确认的需求方向

| 决策点 | 用户选择 |
|-------|---------|
| 服务对象 | 优先服务现有学员 |
| 付费功能 | 不需要 |
| 开发方式 | 原生小程序界面（非H5嵌入） |
| 运营重心 | 督学互动 + 课程学习为主 |
| 登录方式 | 微信授权 + 手机号绑定 |
| 视频来源 | 已有视频平台链接（腾讯视频等） |
| 消息通知 | 需要微信订阅消息推送 |
| 智能体联动 | 需要与扣子智能体互动 |
| 技术基础 | 用户不熟悉前端开发 |

---

## 三、需求边界确认

### 3.1 范围内（Scope In）

#### 核心功能 - 第一期
| 功能 | 优先级 | 说明 |
|-----|--------|------|
| 微信登录 | P0 | 微信授权 + 手机号绑定学员账号 |
| 学员首页 | P0 | 今日课程、任务、督学消息概览 |
| 课表查询 | P0 | 按日/周展示我的课表 |
| 录播课列表 | P0 | 展示录播课，跳转外链播放 |
| 督学消息 | P0 | 接收督学老师的消息/通知 |
| 消息推送 | P0 | 订阅消息（上课提醒、作业提醒） |

#### 增强功能 - 第二期
| 功能 | 优先级 | 说明 |
|-----|--------|------|
| 每日作业 | P1 | 查看作业、提交完成状态 |
| 学习打卡 | P1 | 每日打卡、累计天数 |
| 学习反馈 | P1 | 主动反馈学习状态/困难 |
| 扣子互动 | P1 | 嵌入扣子智能督学对话 |

#### 进阶功能 - 第三期
| 功能 | 优先级 | 说明 |
|-----|--------|------|
| 错题复习 | P2 | 错题本、复习提醒 |
| 学习报告 | P2 | 周报/月报数据展示 |
| 职位查询 | P2 | 快速查询目标职位 |

### 3.2 范围外（Scope Out）

| 排除项 | 原因 |
|-------|------|
| 付费购课 | 用户明确不需要 |
| 在线直播 | 复杂度高，使用现有腾讯会议 |
| 完整题库刷题 | 聚焦督学和课程，刷题为辅 |
| 管理员功能 | 小程序仅面向学员 |
| 多机构 | 仅服务单一机构 |

---

## 四、技术约束

### 4.1 技术栈选择

| 组件 | 选择 | 理由 |
|-----|------|------|
| 小程序框架 | 原生微信小程序 | 官方支持最好，学习资料丰富 |
| UI组件库 | Vant Weapp | 成熟稳定，组件丰富 |
| 后端服务 | 复用现有Flask API | 零开发成本 |
| 认证方式 | JWT Token | 标准方案 |
| 消息推送 | 微信订阅消息 | 官方能力 |

### 4.2 后端扩展需求

需要为小程序新增的API：

| 接口 | 用途 |
|-----|------|
| `/api/v1/wx/login` | 微信登录，获取openid |
| `/api/v1/wx/bindPhone` | 手机号绑定学员账号 |
| `/api/v1/students/me` | 获取当前学员信息 |
| `/api/v1/students/me/schedule` | 获取我的课表 |
| `/api/v1/students/me/recordings` | 获取我的录播课 |
| `/api/v1/students/me/messages` | 获取督学消息 |
| `/api/v1/students/me/checkin` | 学习打卡 |
| `/api/v1/wx/subscribe` | 订阅消息管理 |

### 4.3 微信能力依赖

| 能力 | 用途 | 是否需要资质 |
|-----|------|-------------|
| 微信登录 | 获取用户标识 | 需要小程序AppID |
| 手机号快捷获取 | 绑定学员账号 | 需要认证 |
| 订阅消息 | 推送通知 | 需要申请模板 |
| webview | 播放外链视频 | 需要域名白名单 |

---

## 五、项目特性规范

### 5.1 用户角色

| 角色 | 说明 | 权限 |
|-----|------|------|
| 学员 | 小程序唯一用户角色 | 查看课程、接收消息、提交作业 |

### 5.2 用户体验目标

| 目标 | 描述 |
|-----|------|
| 简洁高效 | 首页一目了然，核心功能直达 |
| 温暖督学 | 突出督学关怀，增强归属感 |
| 学习陪伴 | 打卡激励，进步可视化 |

### 5.3 设计风格

| 项目 | 规范 |
|-----|------|
| 主色调 | 蓝色系（#1890FF）专业、可信赖 |
| 辅助色 | 橙色（#FF6B00）用于强调和激励 |
| 字体 | 系统默认，正文14px，标题16-18px |
| 圆角 | 8-12px，现代简约 |

---

## 六、疑问澄清

### 6.1 已解决的问题

| 问题 | 答案 | 来源 |
|-----|------|------|
| 录播课如何播放？ | 外链跳转（腾讯视频等） | 用户确认 |
| 需要付费功能吗？ | 不需要 | 用户确认 |
| H5页面如何处理？ | 重新开发原生界面 | 用户确认 |
| 消息如何推送？ | 微信订阅消息 | 用户确认 |

### 6.2 待确认问题

| 问题 | 默认方案 | 待确认 |
|-----|---------|-------|
| 小程序名称 | "公考学员助手" | 用户确认 |
| 是否已有小程序AppID？ | 需要申请 | 用户确认 |
| 扣子智能体如何嵌入？ | 使用扣子官方小程序组件 | 技术调研 |
| 视频外链白名单 | 腾讯视频、B站等 | 用户提供 |

---

## 七、验收标准

### 7.1 功能验收

| 功能 | 验收标准 |
|-----|---------|
| 微信登录 | 用户授权后自动登录，首次需绑定手机号 |
| 课表展示 | 正确显示用户所属班次的课表 |
| 录播课 | 点击可跳转至视频平台播放 |
| 督学消息 | 能接收并展示督学老师发送的消息 |
| 订阅消息 | 用户订阅后能收到上课提醒 |

### 7.2 非功能验收

| 项目 | 标准 |
|-----|------|
| 首屏加载 | < 2秒 |
| 页面切换 | < 500ms |
| 兼容性 | iOS 12+ / Android 7+ |
| 体验 | 通过微信审核上线 |

---

## 八、风险评估

| 风险 | 概率 | 影响 | 应对方案 |
|-----|------|------|---------|
| 小程序审核被拒 | 中 | 高 | 提前了解审核规则，避免敏感内容 |
| 手机号获取需认证 | 确定 | 中 | 需要完成小程序认证（300元/年） |
| 视频外链限制 | 低 | 中 | 使用微信支持的视频平台 |
| 用户不熟悉开发 | 确定 | 中 | 提供详细开发指导和文档 |

---

## 九、下一步行动

完成对齐后，进入 **Architect（架构阶段）**：
1. 设计小程序整体架构
2. 设计后端API扩展方案
3. 设计数据库模型扩展
4. 设计页面结构和交互流程

---

> **状态**: 待确认
> 请确认以上内容，特别是「待确认问题」部分。确认后进入架构阶段。
