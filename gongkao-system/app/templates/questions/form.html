{% extends "base.html" %}

{% block title %}{{ '编辑题目' if question else '添加题目' }} - 公考培训管理系统{% endblock %}

{% block content %}
<div class="page-header d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h3 mb-1">{{ '编辑题目' if question else '添加题目' }}</h1>
        <p class="text-muted mb-0">{% if question %}ID: {{ question.id }}{% endif %}</p>
    </div>
    <a href="{{ url_for('questions.index') }}" class="btn btn-outline-secondary">
        <i data-lucide="arrow-left" class="me-1"></i> 返回列表
    </a>
</div>

<form action="{{ url_for('questions.edit', id=question.id) if question else url_for('questions.create') }}" method="POST">
    <div class="row">
        <div class="col-lg-8">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">题目内容</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">题干 <span class="text-danger">*</span></label>
                        <textarea name="stem" class="form-control" rows="4" required>{{ question.stem if question else '' }}</textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">A选项</label>
                            <input type="text" name="option_a" class="form-control" value="{{ question.option_a if question else '' }}">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">B选项</label>
                            <input type="text" name="option_b" class="form-control" value="{{ question.option_b if question else '' }}">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">C选项</label>
                            <input type="text" name="option_c" class="form-control" value="{{ question.option_c if question else '' }}">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">D选项</label>
                            <input type="text" name="option_d" class="form-control" value="{{ question.option_d if question else '' }}">
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">解析</label>
                        <textarea name="analysis" class="form-control" rows="3">{{ question.analysis if question else '' }}</textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">题目属性</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">正确答案 <span class="text-danger">*</span></label>
                        <select name="answer" class="form-select" required>
                            <option value="">请选择</option>
                            {% for opt in ['A', 'B', 'C', 'D'] %}
                            <option value="{{ opt }}" {% if question and question.answer == opt %}selected{% endif %}>{{ opt }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">一级分类</label>
                        <input type="text" name="category" class="form-control" list="categoryList" value="{{ question.category if question else '' }}">
                        <datalist id="categoryList">
                            {% for cat in categories %}
                            <option value="{{ cat }}">
                            {% endfor %}
                        </datalist>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">二级分类/板块</label>
                        <input type="text" name="subcategory" class="form-control" value="{{ question.subcategory if question else '' }}">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">知识点</label>
                        <input type="text" name="knowledge_point" class="form-control" value="{{ question.knowledge_point if question else '' }}">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">难度</label>
                        <select name="difficulty" class="form-select">
                            {% for i in range(1, 6) %}
                            <option value="{{ i }}" {% if question and question.difficulty == i %}selected{% endif %}>
                                {{ '⭐' * i }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg">
                    <i data-lucide="save" class="me-1"></i> {{ '保存修改' if question else '添加题目' }}
                </button>
            </div>
        </div>
    </div>
</form>
{% endblock %}
