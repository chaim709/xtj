<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤ä¹ ä¸­å¿ƒ - {{ student.name }}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f5f7fb;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .header h1 { font-size: 20px; margin-bottom: 8px; }
        .header p { font-size: 14px; opacity: 0.9; }
        
        .container { padding: 15px; }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .stat-value { font-size: 28px; font-weight: bold; }
        .stat-label { font-size: 12px; color: #888; margin-top: 4px; }
        
        .stat-card.due .stat-value { color: #dc2626; }
        .stat-card.mastered .stat-value { color: #16a34a; }
        .stat-card.total .stat-value { color: #1a73e8; }
        
        .action-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
        }
        
        .action-card h2 { font-size: 18px; margin-bottom: 8px; }
        .action-card p { font-size: 14px; opacity: 0.9; margin-bottom: 15px; }
        
        .action-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-decoration: none;
            text-align: center;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 12px;
            color: #333;
        }
        
        .schedule-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .schedule-date {
            font-size: 14px;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .schedule-count {
            background: #e0e7ff;
            color: #4338ca;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
        }
        
        .schedule-items { display: flex; flex-wrap: wrap; gap: 6px; }
        
        .schedule-item {
            padding: 6px 10px;
            background: #f3f4f6;
            border-radius: 6px;
            font-size: 12px;
            color: #666;
        }
        
        .progress-bar {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 15px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #16a34a, #22c55e);
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        .mastery-label {
            text-align: center;
            font-size: 13px;
            color: #666;
            margin-top: 8px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #888;
        }
        
        .empty-state i { font-size: 48px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“š å¤ä¹ ä¸­å¿ƒ</h1>
        <p>{{ student.name }} | è‰¾å®¾æµ©æ–¯è®°å¿†æ›²çº¿</p>
    </div>
    
    <div class="container">
        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats-grid">
            <div class="stat-card due">
                <div class="stat-value">{{ stats.due }}</div>
                <div class="stat-label">å¾…å¤ä¹ </div>
            </div>
            <div class="stat-card mastered">
                <div class="stat-value">{{ stats.mastered }}</div>
                <div class="stat-label">å·²æŒæ¡</div>
            </div>
            <div class="stat-card total">
                <div class="stat-value">{{ stats.total }}</div>
                <div class="stat-label">æ€»é”™é¢˜</div>
            </div>
        </div>
        
        <!-- æŒæ¡è¿›åº¦ -->
        <div class="stat-card" style="margin-bottom: 20px;">
            <div class="section-title" style="text-align: left;">æŒæ¡è¿›åº¦</div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: {{ stats.mastery_rate }}%"></div>
            </div>
            <div class="mastery-label">{{ stats.mastery_rate }}% å·²æŒæ¡</div>
        </div>
        
        <!-- å¼€å§‹å¤ä¹  -->
        {% if stats.due > 0 %}
        <div class="action-card">
            <h2>ğŸ”¥ æœ‰ {{ stats.due }} é¢˜å¾…å¤ä¹ </h2>
            <p>æ ¹æ®è®°å¿†æ›²çº¿ï¼Œè¿™äº›é¢˜ç›®éœ€è¦ä»Šå¤©å¤ä¹ </p>
            <a href="{{ url_for('h5.start_review', student_id=student.id) }}" class="action-btn">
                å¼€å§‹å¤ä¹ 
            </a>
        </div>
        {% else %}
        <div class="action-card" style="background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);">
            <h2>âœ¨ å¤ªæ£’äº†ï¼</h2>
            <p>ä»Šå¤©æ²¡æœ‰éœ€è¦å¤ä¹ çš„é¢˜ç›®ï¼Œç»§ç»­ä¿æŒï¼</p>
            <a href="{{ url_for('h5.recommend_practice', student_id=student.id) }}" class="action-btn" style="color: #16a34a;">
                åšæ–°é¢˜
            </a>
        </div>
        {% endif %}
        
        <!-- å¤ä¹ è®¡åˆ’ -->
        {% if schedule %}
        <div class="section-title">ğŸ“… æœªæ¥7å¤©å¤ä¹ è®¡åˆ’</div>
        {% for date, reviews in schedule.items() %}
        <div class="schedule-card">
            <div class="schedule-date">
                {{ date }}
                <span class="schedule-count">{{ reviews|length }} é¢˜</span>
            </div>
            <div class="schedule-items">
                {% for review in reviews[:5] %}
                <span class="schedule-item">{{ review.question.subcategory or review.question.category or 'ç»¼åˆ' }}</span>
                {% endfor %}
                {% if reviews|length > 5 %}
                <span class="schedule-item">+{{ reviews|length - 5 }} é¢˜</span>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        {% endif %}
        
        <!-- å¿«æ·å…¥å£ -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
            <a href="{{ url_for('h5.my_mistakes', student_id=student.id) }}" 
               style="display: block; padding: 15px; background: white; border-radius: 12px; text-align: center; text-decoration: none; color: #333;">
                ğŸ“‹ é”™é¢˜æœ¬
            </a>
            <a href="{{ url_for('h5.recommend_practice', student_id=student.id) }}" 
               style="display: block; padding: 15px; background: white; border-radius: 12px; text-align: center; text-decoration: none; color: #333;">
                ğŸ¯ æ™ºèƒ½æ¨è
            </a>
        </div>
    </div>
</body>
</html>
